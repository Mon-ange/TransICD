2023-07-26 22:26:45,488 Namespace(log='INFO', random_seed=271, mode='train', data_setting='50', model='Transformer', num_epoch=[1, 30, 100], learning_rate=[0.001], batch_size=128, max_len=200, embed_size=128, freeze_embed=True, label_attn_expansion=2, num_trans_layers=2, num_attn_heads=8, trans_forward_expansion=4, dropout_rate=0.1)

2023-07-26 22:26:46,707 In train set, average code counts per discharge summary: 1.0
2023-07-26 22:26:46,767 Final number of labels/codes: 48
2023-07-26 22:26:46,857 train set true item count: 31616


2023-07-26 22:26:47,139 In dev set, average code counts per discharge summary: 1.0
2023-07-26 22:26:47,157 Final number of labels/codes: 48
2023-07-26 22:26:47,194 dev set true item count: 10496


2023-07-26 22:26:47,379 In test set, average code counts per discharge summary: 1.0
2023-07-26 22:26:47,397 Final number of labels/codes: 48
2023-07-26 22:26:47,522 test set true item count: 10496


2023-07-26 22:26:47,747 Size of training vocabulary including PAD, UNK: 20024
2023-07-26 23:14:37,938 Taining labels are: ['A41.901', 'C11.900', 'C16.900', 'C18.900', 'C20.x00', 'C22.900', 'C34.90A', 'C50.900', 'D25.900', 'E11.401+', 'E11.900', 'H25.900', 'H81.901', 'I10.x05', 'I10.x0H', 'I24.901', 'I25.103', 'I61.900', 'I64.x00', 'J18.000', 'J18.900', 'J44.100', 'J98.414', 'K35.900', 'K40.901', 'K63.500', 'K65.000', 'K74.607', 'K85.900', 'K92.207', 'K92.208', 'K92.210', 'M06.900', 'N18.001', 'N63.x00', 'O34.201', 'O42.900', 'O47.100', 'O47.900', 'O60.200', 'P07.30A', 'R10.402', 'R50.900', 'R93.203', 'Z34.900', 'Z35.900', 'Z51.102', 'Z51.805']

2023-07-26 23:14:40,885 Total token count (including PAD, UNK) of full preprocessed discharge summaries: 20024
2023-07-26 23:14:41,528 Training with: HyperParams(learning_rate=0.001, num_epoch=1)
2023-07-26 23:14:41,535 Training Started...
2023-07-26 23:15:18,442 Training finished.

2023-07-26 23:15:54,916 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:15:54,918 target
2023-07-26 23:15:54,918 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:15:55,040 train Accuracy: 0.8181616902834008
2023-07-26 23:15:57,903 train f1 score (micro): 0.8181616902834007
2023-07-26 23:15:57,904 train f1 score (macro): 0.638643684984756
2023-07-26 23:15:57,904 train auc score (micro): 0.9953796524671487
2023-07-26 23:15:57,904 train auc score (macro): 0.9907105957855894
2023-07-26 23:15:57,904 train precision at ks [1, 5, 8, 10, 15]: [0.8181616902834008, 0.1973178137651822, 0.12426461285425101, 0.09956034919028342, 0.0664937584345479]

2023-07-26 23:16:12,747 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:16:12,747 target
2023-07-26 23:16:12,747 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [1. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:16:12,785 dev Accuracy: 0.7955411585365854
2023-07-26 23:16:13,703 dev f1 score (micro): 0.7955411585365854
2023-07-26 23:16:13,703 dev f1 score (macro): 0.6140789748994883
2023-07-26 23:16:13,703 dev auc score (micro): 0.9939602332306072
2023-07-26 23:16:13,703 dev auc score (macro): 0.9887391120063072
2023-07-26 23:16:13,703 dev precision at ks [1, 5, 8, 10, 15]: [0.7955411585365854, 0.19500762195121954, 0.12376143292682927, 0.09927591463414637, 0.06641895325203251]

2023-07-26 23:16:29,193 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]]
2023-07-26 23:16:29,195 target
2023-07-26 23:16:29,195 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]]
2023-07-26 23:16:29,239 test Accuracy: 0.8004001524390244
2023-07-26 23:16:30,157 test f1 score (micro): 0.8004001524390244
2023-07-26 23:16:30,157 test f1 score (macro): 0.6233889145069672
2023-07-26 23:16:30,157 test auc score (micro): 0.9947253751623792
2023-07-26 23:16:30,157 test auc score (macro): 0.9899718978982355
2023-07-26 23:16:30,157 test precision at ks [1, 5, 8, 10, 15]: [0.8004001524390244, 0.19727515243902444, 0.12419016768292683, 0.09947599085365855, 0.0664697662601626]

2023-07-26 23:16:30,211 Training with: HyperParams(learning_rate=0.001, num_epoch=30)
2023-07-26 23:16:30,212 Training Started...
2023-07-26 23:28:08,597 Training finished.

2023-07-26 23:28:44,434 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:28:44,435 target
2023-07-26 23:28:44,435 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:28:44,553 train Accuracy: 0.8898342611336032
2023-07-26 23:28:47,432 train f1 score (micro): 0.8898342611336033
2023-07-26 23:28:47,432 train f1 score (macro): 0.7883968662130747
2023-07-26 23:28:47,433 train auc score (micro): 0.9990360745964029
2023-07-26 23:28:47,433 train auc score (macro): 0.9974102172341457
2023-07-26 23:28:47,433 train precision at ks [1, 5, 8, 10, 15]: [0.8898342611336032, 0.19990511133603242, 0.125, 0.1, 0.06666666666666668]

2023-07-26 23:29:02,420 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [1. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:29:02,421 target
2023-07-26 23:29:02,421 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [1. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:29:02,458 dev Accuracy: 0.8045922256097561
2023-07-26 23:29:03,384 dev f1 score (micro): 0.8045922256097561
2023-07-26 23:29:03,384 dev f1 score (macro): 0.6775901919010255
2023-07-26 23:29:03,384 dev auc score (micro): 0.9948947457510253
2023-07-26 23:29:03,385 dev auc score (macro): 0.9901267852399919
2023-07-26 23:29:03,385 dev precision at ks [1, 5, 8, 10, 15]: [0.8045922256097561, 0.19676067073170733, 0.12404725609756098, 0.09949504573170734, 0.06650787601626015]

2023-07-26 23:29:18,792 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:29:18,793 target
2023-07-26 23:29:18,793 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-26 23:29:18,829 test Accuracy: 0.8245998475609756
2023-07-26 23:29:19,752 test f1 score (micro): 0.8245998475609756
2023-07-26 23:29:19,752 test f1 score (macro): 0.6945746717982169
2023-07-26 23:29:19,752 test auc score (micro): 0.9963425059031681
2023-07-26 23:29:19,752 test auc score (macro): 0.9920622949183122
2023-07-26 23:29:19,752 test precision at ks [1, 5, 8, 10, 15]: [0.8245998475609756, 0.1981707317073171, 0.12447599085365854, 0.09968559451219514, 0.06655233739837398]

2023-07-26 23:29:19,805 Training with: HyperParams(learning_rate=0.001, num_epoch=100)
2023-07-26 23:29:19,806 Training Started...
2023-07-27 00:08:15,317 Training finished.

2023-07-27 00:08:51,394 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-27 00:08:51,395 target
2023-07-27 00:08:51,395 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-27 00:08:51,512 train Accuracy: 0.9484438259109311
2023-07-27 00:08:54,410 train f1 score (micro): 0.9484438259109311
2023-07-27 00:08:54,410 train f1 score (macro): 0.917129298552711
2023-07-27 00:08:54,410 train auc score (micro): 0.9997947992752266
2023-07-27 00:08:54,410 train auc score (macro): 0.9995314029414807
2023-07-27 00:08:54,410 train precision at ks [1, 5, 8, 10, 15]: [0.9484438259109311, 0.2, 0.125, 0.1, 0.06666666666666668]

2023-07-27 00:09:09,439 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-27 00:09:09,440 target
2023-07-27 00:09:09,440 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-07-27 00:09:09,477 dev Accuracy: 0.7884908536585366
2023-07-27 00:09:10,419 dev f1 score (micro): 0.7884908536585366
2023-07-27 00:09:10,419 dev f1 score (macro): 0.6707422178791073
2023-07-27 00:09:10,419 dev auc score (micro): 0.9923146665862023
2023-07-27 00:09:10,419 dev auc score (macro): 0.9861076731797942
2023-07-27 00:09:10,419 dev precision at ks [1, 5, 8, 10, 15]: [0.7884908536585366, 0.1950266768292683, 0.1232374237804878, 0.09889481707317076, 0.06624110772357722]

2023-07-27 00:09:26,115 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 1. 0.]]
2023-07-27 00:09:26,116 target
2023-07-27 00:09:26,116 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 1. 0.]]
2023-07-27 00:09:26,153 test Accuracy: 0.8069740853658537
2023-07-27 00:09:27,069 test f1 score (micro): 0.8069740853658537
2023-07-27 00:09:27,069 test f1 score (macro): 0.6859507229503965
2023-07-27 00:09:27,069 test auc score (micro): 0.9946545004076665
2023-07-27 00:09:27,069 test auc score (macro): 0.9885738032989604
2023-07-27 00:09:27,070 test precision at ks [1, 5, 8, 10, 15]: [0.8069740853658537, 0.19712271341463414, 0.12404725609756098, 0.0994283536585366, 0.06645071138211382]

