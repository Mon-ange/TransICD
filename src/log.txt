(ticd) PS D:\MT\project\TransICD\code> python main.py --mode train
use_cuda : True
train
train
train
../data/hainan//train_full.csv
D:\MT\project\TransICD\code\data.py:30: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat inste
ad.
  data = data.append({'HADM_ID': -1, 'TEXT': 'remove', 'LABELS': all_codes},
load_dataset
../data/hainan//dev_full.csv
D:\MT\project\TransICD\code\data.py:30: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat inste
ad.
  data = data.append({'HADM_ID': -1, 'TEXT': 'remove', 'LABELS': all_codes},
load_dataset
../data/hainan//test_full.csv
D:\MT\project\TransICD\code\data.py:30: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat inste
ad.
  data = data.append({'HADM_ID': -1, 'TEXT': 'remove', 'LABELS': all_codes},
load_dataset
['A41.901', 'C11.900', 'C16.900', 'C18.900', 'C20.x00', 'C22.900', 'C34.90A', 'C50.900', 'D25.900', 'E11.401+', 'E11.900', 'H25.900', 'H81.901', 'I10.x05', 'I10.x0H', 'I
24.901', 'I25.103', 'I61.900', 'I64.x00', 'J18.000', 'J18.900', 'J44.100', 'J98.414', 'K35.900', 'K40.901', 'K63.500', 'K65.000', 'K74.607', 'K85.900', 'K92.207', 'K92.2
08', 'K92.210', 'M06.900', 'N18.001', 'N63.x00', 'O34.201', 'O42.900', 'O47.100', 'O47.900', 'O60.200', 'P07.30A', 'R10.402', 'R50.900', 'R93.203', 'Z34.900', 'Z35.900',
 'Z51.102', 'Z51.805']
['A41.901', 'C11.900', 'C16.900', 'C18.900', 'C20.x00', 'C22.900', 'C34.90A', 'C50.900', 'D25.900', 'E11.401+', 'E11.900', 'H25.900', 'H81.901', 'I10.x05', 'I10.x0H', 'I
24.901', 'I25.103', 'I61.900', 'I64.x00', 'J18.000', 'J18.900', 'J44.100', 'J98.414', 'K35.900', 'K40.901', 'K63.500', 'K65.000', 'K74.607', 'K85.900', 'K92.207', 'K92.2
08', 'K92.210', 'M06.900', 'N18.001', 'N63.x00', 'O34.201', 'O42.900', 'O47.100', 'O47.900', 'O60.200', 'P07.30A', 'R10.402', 'R50.900', 'R93.203', 'Z34.900', 'Z35.900',
 'Z51.102', 'Z51.805']
['A41.901', 'C11.900', 'C16.900', 'C18.900', 'C20.x00', 'C22.900', 'C34.90A', 'C50.900', 'D25.900', 'E11.401+', 'E11.900', 'H25.900', 'H81.901', 'I10.x05', 'I10.x0H', 'I
24.901', 'I25.103', 'I61.900', 'I64.x00', 'J18.000', 'J18.900', 'J44.100', 'J98.414', 'K35.900', 'K40.901', 'K63.500', 'K65.000', 'K74.607', 'K85.900', 'K92.207', 'K92.2
08', 'K92.210', 'M06.900', 'N18.001', 'N63.x00', 'O34.201', 'O42.900', 'O47.100', 'O47.900', 'O60.200', 'P07.30A', 'R10.402', 'R50.900', 'R93.203', 'Z34.900', 'Z35.900',
 'Z51.102', 'Z51.805']
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\acguc\AppData\Local\Temp\jieba.cache
Loading model cost 0.772 seconds.
Prefix dict has been built successfully.
Indexing text......
Indexing text......
print dataset...................................................................
D:\MT\project\TransICD\code\data.py:106: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list
to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at C:\cb\pytorch_1000000000000\work\torch\csrc\utils\tensorto a single
_new.cpp:233.)
  weights = torch.tensor(W, dtype=torch.float)
Epoch 1 started ... Ended
Epoch 2 started ... Ended
Epoch 3 started ... Ended
Epoch 4 started ... Ended
Epoch 5 started ... Ended
Epoch 6 started ... Ended
Epoch 7 started ... Ended
Epoch 8 started ... Ended
Epoch 9 started ... Ended
Epoch 10 started ... Ended
Epoch 11 started ... Ended
Epoch 12 started ... Ended
Epoch 13 started ... Ended
Epoch 14 started ... Ended
Epoch 15 started ... Ended
Epoch 16 started ... Ended
Epoch 17 started ... Ended
Epoch 18 started ... Ended
Epoch 19 started ... Ended
Epoch 20 started ... Ended
Epoch 21 started ... Ended
Epoch 22 started ... Ended
Epoch 23 started ... Ended
Epoch 24 started ... Ended
Epoch 25 started ... Ended
Epoch 26 started ... Ended
Epoch 27 started ... Ended
Epoch 28 started ... Ended
Epoch 29 started ... Ended
Epoch 30 started ... Ended
Traceback (most recent call last):
  File "D:\MT\project\TransICD\code\main.py", line 93, in <module>
    run(args, device)
  File "D:\MT\project\TransICD\code\main.py", line 57, in run
    train(model, train_set, dev_set, test_set, hyper_params, args.batch_size, device)
  File "D:\MT\project\TransICD\code\trainer.py", line 48, in train
    compute_scores(probabs, targets, hyper_params, dtset='train')
  File "D:\MT\project\TransICD\code\trainer.py", line 122, in compute_scores
    preds[index] = 1
IndexError: index 239056 is out of bounds for axis 0 with size 31720
