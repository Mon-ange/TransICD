2023-06-15 00:47:44,256 Namespace(log='INFO', random_seed=271, mode='train', data_setting='50', model='Transformer', num_epoch=[100], learning_rate=[0.001], batch_size=128, max_len=200, embed_size=128, freeze_embed=True, label_attn_expansion=2, num_trans_layers=2, num_attn_heads=8, trans_forward_expansion=4, dropout_rate=0.1)

2023-06-15 00:47:44,929 In train set, average code counts per discharge summary: 1.0014805481178137
2023-06-15 00:47:44,959 Final number of labels/codes: 48
2023-06-15 00:47:45,037 train set true item count: 31744


2023-06-15 00:47:45,321 In dev set, average code counts per discharge summary: 1.0044285310468293
2023-06-15 00:47:45,331 Final number of labels/codes: 48
2023-06-15 00:47:45,371 dev set true item count: 10608


2023-06-15 00:47:45,559 In test set, average code counts per discharge summary: 1.004429365752521
2023-06-15 00:47:45,570 Final number of labels/codes: 48
2023-06-15 00:47:45,608 test set true item count: 10608


2023-06-15 00:47:45,682 Size of training vocabulary including PAD, UNK: 58350
2023-06-15 00:47:45,684 Building prefix dict from the default dictionary ...
2023-06-15 00:47:45,687 Loading model from cache C:\Users\acguc\AppData\Local\Temp\jieba.cache
2023-06-15 00:47:46,470 Loading model cost 0.785 seconds.
2023-06-15 00:47:46,470 Prefix dict has been built successfully.
2023-06-15 00:49:43,653 Taining labels are: ['A41.901', 'C11.900', 'C16.900', 'C18.900', 'C20.x00', 'C22.900', 'C34.90A', 'C50.900', 'D25.900', 'E11.401+', 'E11.900', 'H25.900', 'H81.901', 'I10.x05', 'I10.x0H', 'I24.901', 'I25.103', 'I61.900', 'I64.x00', 'J18.000', 'J18.900', 'J44.100', 'J98.414', 'K35.900', 'K40.901', 'K63.500', 'K65.000', 'K74.607', 'K85.900', 'K92.207', 'K92.208', 'K92.210', 'M06.900', 'N18.001', 'N63.x00', 'O34.201', 'O42.900', 'O47.100', 'O47.900', 'O60.200', 'P07.30A', 'R10.402', 'R50.900', 'R93.203', 'Z34.900', 'Z35.900', 'Z51.102', 'Z51.805']

2023-06-15 00:49:51,810 Total token count (including PAD, UNK) of full preprocessed discharge summaries: 58350
2023-06-15 00:49:52,809 Training with: HyperParams(learning_rate=0.001, num_epoch=100)
2023-06-15 00:49:52,809 Training Started...
2023-06-15 01:36:37,811 Training finished.

2023-06-15 01:36:58,570 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:36:58,572 target
2023-06-15 01:36:58,572 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 1. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:37:01,555 train Accuracy: 0.42529716742539203
2023-06-15 01:37:01,555 train f1 score (micro): 0.42529716742539203
2023-06-15 01:37:01,555 train f1 score (macro): 0.46802251158100666
2023-06-15 01:37:01,555 train auc score (micro): 0.9036956666529955
2023-06-15 01:37:01,555 train auc score (macro): 0.8929099114141347
2023-06-15 01:37:01,555 train precision at ks [1, 5, 8, 10, 15]: [0.42529716742539203, 0.15106221547799695, 0.10503603945371776, 0.08768335862417806, 0.062114314618108235]

2023-06-15 01:37:14,992 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 1.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:37:14,993 target
2023-06-15 01:37:14,993 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:37:15,939 dev Accuracy: 0.050190114068441066
2023-06-15 01:37:15,939 dev f1 score (micro): 0.05019011406844106
2023-06-15 01:37:15,939 dev f1 score (macro): 0.02009230669058853
2023-06-15 01:37:15,939 dev auc score (micro): 0.63841577236205
2023-06-15 01:37:15,939 dev auc score (macro): 0.5051282902050561
2023-06-15 01:37:15,939 dev precision at ks [1, 5, 8, 10, 15]: [0.050190114068441066, 0.04302281368821293, 0.03997148288973384, 0.03805133079847908, 0.03387832699619772]

2023-06-15 01:37:29,240 [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:37:29,241 target
2023-06-15 01:37:29,241 [[0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [1. 0. 0. ... 0. 0. 0.]]
2023-06-15 01:37:30,210 test Accuracy: 0.04875744117924974
2023-06-15 01:37:30,210 test f1 score (micro): 0.04875744117924974
2023-06-15 01:37:30,210 test f1 score (macro): 0.02053968404310749
2023-06-15 01:37:30,210 test auc score (micro): 0.6382355541745603
2023-06-15 01:37:30,211 test auc score (macro): 0.5004924508023959
2023-06-15 01:37:30,211 test precision at ks [1, 5, 8, 10, 15]: [0.04875744117924974, 0.042502126051214215, 0.03864688651611074, 0.03724841727298498, 0.033399477148886574]

